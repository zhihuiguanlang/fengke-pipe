(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76aa910d"],{1550:function(t,e,i){"use strict";i("d7fd");var a=i("4a37"),n=i("3bb3"),l=i("3373"),s=i("c652");e["a"]=a["a"].extend({name:"v-file-input",model:{prop:"value",event:"change"},props:{chips:Boolean,clearable:{type:Boolean,default:!0},counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},placeholder:String,prependIcon:{type:String,default:"$file"},readonly:{type:Boolean,default:!1},showSize:{type:[Boolean,Number],default:!1,validator:t=>"boolean"===typeof t||[1e3,1024].includes(t)},smallChips:Boolean,truncateLength:{type:[Number,String],default:22},type:{type:String,default:"file"},value:{default:void 0,validator:t=>Object(l["E"])(t).every(t=>null!=t&&"object"===typeof t)}},computed:{classes(){return{...a["a"].options.computed.classes.call(this),"v-file-input":!0}},computedCounterValue(){const t=this.isMultiple&&this.lazyValue?this.lazyValue.length:this.lazyValue instanceof File?1:0;if(!this.showSize)return this.$vuetify.lang.t(this.counterString,t);const e=this.internalArrayValue.reduce((t,{size:e=0})=>t+e,0);return this.$vuetify.lang.t(this.counterSizeString,t,Object(l["u"])(e,1024===this.base))},internalArrayValue(){return Object(l["E"])(this.internalValue)},internalValue:{get(){return this.lazyValue},set(t){this.lazyValue=t,this.$emit("change",this.lazyValue)}},isDirty(){return this.internalArrayValue.length>0},isLabelActive(){return this.isDirty},isMultiple(){return this.$attrs.hasOwnProperty("multiple")},text(){return this.isDirty?this.internalArrayValue.map(t=>{const{name:e="",size:i=0}=t,a=this.truncateText(e);return this.showSize?`${a} (${Object(l["u"])(i,1024===this.base)})`:a}):[this.placeholder]},base(){return"boolean"!==typeof this.showSize?this.showSize:void 0},hasChips(){return this.chips||this.smallChips}},watch:{readonly:{handler(t){!0===t&&Object(s["b"])("readonly is not supported on <v-file-input>",this)},immediate:!0},value(t){const e=this.isMultiple?t:t?[t]:[];Object(l["i"])(e,this.$refs.input.files)||(this.$refs.input.value="")}},methods:{clearableCallback(){this.internalValue=this.isMultiple?[]:void 0,this.$refs.input.value=""},genChips(){return this.isDirty?this.text.map((t,e)=>this.$createElement(n["a"],{props:{small:this.smallChips},on:{"click:close":()=>{const t=this.internalValue;t.splice(e,1),this.internalValue=t}}},[t])):[]},genInput(){const t=a["a"].options.methods.genInput.call(this);return delete t.data.domProps.value,delete t.data.on.input,t.data.on.change=this.onInput,[this.genSelections(),t]},genPrependSlot(){if(!this.prependIcon)return null;const t=this.genIcon("prepend",()=>{this.$refs.input.click()});return this.genSlot("prepend","outer",[t])},genSelectionText(){const t=this.text.length;return t<2?this.text:this.showSize&&!this.counter?[this.computedCounterValue]:[this.$vuetify.lang.t(this.counterString,t)]},genSelections(){const t=[];return this.isDirty&&this.$scopedSlots.selection?this.internalArrayValue.forEach((e,i)=>{this.$scopedSlots.selection&&t.push(this.$scopedSlots.selection({text:this.text[i],file:e,index:i}))}):t.push(this.hasChips&&this.isDirty?this.genChips():this.genSelectionText()),this.$createElement("div",{staticClass:"v-file-input__text",class:{"v-file-input__text--placeholder":this.placeholder&&!this.isDirty,"v-file-input__text--chips":this.hasChips&&!this.$scopedSlots.selection}},t)},genTextFieldSlot(){const t=a["a"].options.methods.genTextFieldSlot.call(this);return t.data.on={...t.data.on||{},click:()=>this.$refs.input.click()},t},onInput(t){const e=[...t.target.files||[]];this.internalValue=this.isMultiple?e:e[0],this.initialValue=this.internalValue},onKeyDown(t){this.$emit("keydown",t)},truncateText(t){if(t.length<Number(this.truncateLength))return t;const e=Math.floor((Number(this.truncateLength)-1)/2);return`${t.slice(0,e)}…${t.slice(t.length-e)}`}}})},1612:function(t,e,i){"use strict";var a=i("bd49"),n=i.n(a);n.a},"4a37":function(t,e,i){"use strict";var a=i("14b5");e["a"]=a["a"]},b4fb:function(t,e,i){"use strict";var a=i("1c8b"),n=i("efe2"),l=i("74e7"),s=i("a719"),o=i("3553"),r=i("d88d"),c=i("1bbd"),d=i("1ca1"),u=i("1ea7"),h=i("90fb"),p=i("f594"),f=h("isConcatSpreadable"),m=9007199254740991,v="Maximum allowed index exceeded",g=p>=51||!n((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),b=u("concat"),y=function(t){if(!s(t))return!1;var e=t[f];return void 0!==e?!!e:l(t)},x=!g||!b;a({target:"Array",proto:!0,forced:x},{concat:function(t){var e,i,a,n,l,s=o(this),u=d(s,0),h=0;for(e=-1,a=arguments.length;e<a;e++)if(l=-1===e?s:arguments[e],y(l)){if(n=r(l.length),h+n>m)throw TypeError(v);for(i=0;i<n;i++,h++)i in l&&c(u,h,l[i])}else{if(h>=m)throw TypeError(v);c(u,h++,l)}return u.length=h,u}})},bd49:function(t,e,i){},d7fd:function(t,e,i){},eef63:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"plan"},[i("div",{staticClass:"handle"},[i("v-btn",{staticClass:"mr-3",attrs:{outlined:"",color:"light-green"},on:{click:t.addPlan}},[i("v-icon",{attrs:{left:""},domProps:{textContent:t._s("mdi-plus")}}),t._v(" 添加规划档案 ")],1),i("v-btn",{staticClass:"mr-3",attrs:{outlined:"",color:"cyan"},on:{click:t.amendPlan}},[i("v-icon",{attrs:{left:""},domProps:{textContent:t._s("mdi-pencil")}}),t._v(" 编辑 ")],1),i("v-btn",{staticClass:"mr-3",attrs:{color:"error",loading:t.deleteloading},on:{click:t.deleted}},[i("v-icon",{attrs:{left:""},domProps:{textContent:t._s("mdi-delete")}}),t._v(" 删除 ")],1),i("v-btn",{staticClass:"mr-3",attrs:{outlined:"",color:"teal",loading:t.loading},on:{click:t.refresh}},[i("v-icon",{attrs:{left:""},domProps:{textContent:t._s("mdi-cached")}}),t._v(" 刷新 ")],1),i("v-btn",{staticClass:"mr-3",attrs:{outlined:"",color:"cyan"},on:{click:t.download}},[i("v-icon",{attrs:{left:""},domProps:{textContent:t._s("mdi-email")}}),t._v(" 下载 ")],1)],1),i("v-alert",{staticClass:"alert",attrs:{tile:"",light:"",dense:"",width:"150",height:"18",color:"cyan",border:"left",elevation:"0","colored-border":"",transition:"scale-transition"}},[t._v(" 档案列表 ")]),i("div",{staticClass:"elevation-7"},[i("v-data-table",{attrs:{light:"","show-select":"","fixed-header":"","single-select":"","calculate-width":"",height:"500","item-key":"id",items:t.plan,loading:t.table,headers:t.headers,page:t.current,"items-per-page":t.limit,"loading-text":"loading...","server-items-length":t.total,"footer-props":{itemsPerPageOptions:[5,10,15,20]}},on:{"update:page":[function(e){t.current=e},t.updatePage],"update:items-per-page":t.updateItem},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}})],1),i("v-dialog",{attrs:{light:"",persistent:"","max-width":"600px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[t._v("Plan Profile")])]),i("v-card-text",[i("v-container",[i("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[t.form.id?i("v-text-field",{attrs:{disabled:"",label:"原始文档*","prepend-icon":"mdi-clipboard-check"},model:{value:t.form.fileName,callback:function(e){t.$set(t.form,"fileName",e)},expression:"form.fileName"}}):t._e(),t.dialog?i("v-file-input",{attrs:{light:"",counter:"",required:"","show-size":"",accept:".xlsx",rules:t.rule.file,label:t.form.id?"更换文档*":"添加文档","prepend-icon":t.form.id?"mdi-clipboard-flow":"mdi-clipboard-plus"},on:{change:t.choose}}):t._e()],1)],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.close}},[t._v("关闭")]),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.save}},[t._v("保存")])],1)],1)],1),i("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.wait,callback:function(e){t.wait=e},expression:"wait"}},[i("v-card",{attrs:{color:"primary",dark:""}},[i("v-card-text",{staticClass:"pt-2"},[t._v(" Please stand by "),i("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},n=[],l=(i("b4fb"),i("0eaa")),s=i("4777"),o={name:"plan",data:function(){return{http:s["a"],headers:[{text:"文档名称",align:"center",value:"fileName",width:200},{text:"上传时间",align:"center",value:"createTime",width:200},{text:"上传人",align:"center",value:"uploader",width:200},{text:"文档大小",align:"center",value:"size",width:200}],page:1,type:2,total:0,limit:10,current:1,plan:[],form:{file:""},rule:{file:[function(t){return!!t||"必填"}]},select:[],wait:!1,valid:!0,table:!1,dialog:!1,loading:!1,deleteloading:!1}},mounted:function(){this.myPlan()},methods:{myPlan:function(){var t=this;this.table=!0;var e=this.page,i=this.limit,a=this.type;this.$axios.post("/dataManage/document/selectFile",{page:e,type:a,limit:i}).then((function(e){if(e){var i=e.result,a=i.total,n=i.list,l=i.pageNum;t.plan=n,t.total=a,t.current=l}t.table=!1,t.loading=!1}))},updatePage:function(t){this.page=t,this.myPlan()},updateItem:function(t){this.limit=t,this.myPlan()},deleted:function(){var t=this;if(this.select[0]){var e=this.select[0],i=e.id,a=e.filePath;this.deleteloading=!0,this.$axios.post("/dataManage/document/deleteFile",{id:i,filePath:a}).then((function(e){e&&(t.$notice.success("删除成功"),t.select=[],t.myPlan()),t.deleteloading=!1}))}else this.$notice.error("请选择删除项")},refresh:function(){this.loading=!0,this.myPlan()},close:function(){this.dialog=!1,this.$refs.form.reset()},addPlan:function(){delete this.form["id"],this.dialog=!0},amendPlan:function(){this.select[0]?(this.form=Object(l["a"])({},this.select[0]),this.dialog=!0):this.$notice.error("请选择编辑项")},choose:function(t){this.form.file=t},save:function(){var t=this;if(this.$refs.form.validate(),this.valid){this.wait=!0;var e=this.type,i=this.form,a=i.id,n=void 0===a?null:a,l=i.file,s=new FormData;s.append("file",l),s.append("type",e),s.append("uploader","ADMIN"),n&&s.append("id",n),this.$axios.post("/dataManage/document/uploadOrUpdateFile",s).then((function(e){e&&(t.$notice.success("操作成功"),n||(t.page=1),t.select=[],t.myPlan(),t.close()),t.wait=!1}))}},download:function(){var t=this;if(this.select[0]){this.wait=!0;var e=this.select[0].id;this.$notice.normal("正在下载"),window.open("".concat(s["a"].system,"/dataManage/document/downloadFile?id=").concat(e),"_self"),setTimeout((function(){t.wait=!1}),500)}else this.$notice.error("请选择下载项")}}},r=o,c=(i("1612"),i("4023")),d=i("763f"),u=i.n(d),h=i("e9e4"),p=i("7f93"),f=i("339e"),m=i("30d7"),v=i("d41d"),g=i("53b9"),b=i("8150"),y=i("1550"),x=i("c30a"),w=i("5fa2"),$=i("594f"),V=i("e935"),C=i("14b5"),S=Object(c["a"])(r,a,n,!1,null,"5ceb67cc",null);e["default"]=S.exports;u()(S,{VAlert:h["a"],VBtn:p["a"],VCard:f["a"],VCardActions:m["a"],VCardText:m["b"],VCardTitle:m["c"],VContainer:v["a"],VDataTable:g["a"],VDialog:b["a"],VFileInput:y["a"],VForm:x["a"],VIcon:w["a"],VProgressLinear:$["a"],VSpacer:V["a"],VTextField:C["a"]})}}]);
//# sourceMappingURL=chunk-76aa910d.5094102f.js.map